{"version":3,"sources":["webpack://project-structure/./src/components/range-picker/index.js","webpack://project-structure/./src/components/sortable-table/index.js","webpack://project-structure/./src/components/column-chart/index.js","webpack://project-structure/./src/pages/dashboard/bestsellers-header.js","webpack://project-structure/./src/pages/dashboard/index.js","webpack://project-structure/./src/utils/fetch-json.js"],"names":["RangePicker","date","toLocaleString","dateStyle","constructor","from","Date","to","event","isOpen","this","element","classList","contains","isRangePicker","target","close","showDateFrom","selected","render","formatDate","document","createElement","innerHTML","template","firstElementChild","subElements","getSubElements","initEventListeners","subElement","querySelectorAll","dataset","input","selector","addEventListener","onDocumentClick","toggle","onSelectorClick","renderDateRangePicker","onRangePickerCellClick","remove","showDate1","showDate2","setMonth","getMonth","renderCalendar","controlLeft","querySelector","controlRight","prev","next","renderHighlight","cell","value","cellDate","toISOString","add","selectedFromElem","closest","selectedToElem","showDate","setDate","monthStr","month","table","dayIndex","getDay","getDate","dateValue","selectingFrom","dispatchEvent","CustomEvent","bubbles","detail","removeEventListener","destroy","SortableTable","headersConfig","url","sorted","id","find","item","sortable","order","isSortLocally","step","start","end","range","rowTemplate","html","async","bottom","getBoundingClientRect","documentElement","clientHeight","loading","data","loadData","update","column","append","arrow","sortOnClient","sortOnServer","getTemplate","getTableHeader","getTableBody","reduce","acc","map","header","getHeaderRow","join","title","getHeaderSortingArrow","getTableRows","getTableRow","wrapper","renderRows","URL","process","searchParams","set","fetchJson","toString","sortedData","sortData","body","length","addRows","arr","sortType","direction","asc","desc","sort","a","b","localeCompare","rows","childNodes","onHeaderClick","window","onWindowScroll","ColumnChart","label","link","formatHeading","textContent","setNewRange","Object","values","getHeaderValue","getColumnBody","chartHeight","getLink","accum","maxValue","Math","max","entries","key","scale","percent","toFixed","tooltip","floor","Page","initialize","initComponents","rangePicker","sortableTable","ordersChart","salesChart","customersChart","components","getComponents","keys","forEach","component","root","onRangeSelect","params","response","fetch","err","FetchError","ok","errorText","statusText","json","error","message","status","Error","super","reason","alert"],"mappings":"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","file":"dashboard-index-js-748.js","sourcesContent":["export default class RangePicker {\r\n  element;\r\n  subElements = {};\r\n  selectingFrom = true;\r\n  selected = {\r\n    from: new Date(),\r\n    to: new Date()\r\n  };\r\n\r\n  static formatDate(date) {\r\n    return date.toLocaleString('ru', {dateStyle: 'short'});\r\n  }\r\n\r\n  onDocumentClick = event => {\r\n    const isOpen = this.element.classList.contains('rangepicker_open');\r\n    const isRangePicker = this.element.contains(event.target);\r\n\r\n    if (isOpen && !isRangePicker) {\r\n      this.close();\r\n    }\r\n  };\r\n\r\n  constructor({from = new Date(), to = new Date()} = {}) {\r\n    this.showDateFrom = new Date(from);\r\n    this.selected = {from, to};\r\n\r\n    this.render();\r\n  }\r\n\r\n  get template() {\r\n    const from = RangePicker.formatDate(this.selected.from);\r\n    const to = RangePicker.formatDate(this.selected.to);\r\n\r\n    return `<div class=\"rangepicker\">\r\n      <div class=\"rangepicker__input\" data-element=\"input\">\r\n        <span data-element=\"from\">${from}</span> -\r\n        <span data-element=\"to\">${to}</span>\r\n      </div>\r\n      <div class=\"rangepicker__selector\" data-element=\"selector\"></div>\r\n    </div>`;\r\n  }\r\n\r\n  render() {\r\n    const element = document.createElement('div');\r\n\r\n    element.innerHTML = this.template;\r\n\r\n    this.element = element.firstElementChild;\r\n    this.subElements = this.getSubElements(element);\r\n\r\n    this.initEventListeners();\r\n  }\r\n\r\n  getSubElements(element) {\r\n    const subElements = {};\r\n\r\n    for (const subElement of element.querySelectorAll('[data-element]')) {\r\n      subElements[subElement.dataset.element] = subElement;\r\n    }\r\n\r\n    return subElements;\r\n  }\r\n\r\n  initEventListeners() {\r\n    const {input, selector} = this.subElements;\r\n\r\n    document.addEventListener('click', this.onDocumentClick, true);\r\n    input.addEventListener('click', () => this.toggle());\r\n    selector.addEventListener('click', event => this.onSelectorClick(event));\r\n  }\r\n\r\n  toggle() {\r\n    this.element.classList.toggle('rangepicker_open');\r\n    this.renderDateRangePicker();\r\n  }\r\n\r\n  onSelectorClick({target}) {\r\n    if (target.classList.contains('rangepicker__cell')) {\r\n      this.onRangePickerCellClick(target);\r\n    }\r\n  }\r\n\r\n  close() {\r\n    this.element.classList.remove('rangepicker_open');\r\n  }\r\n\r\n  renderDateRangePicker() {\r\n    const showDate1 = new Date(this.showDateFrom);\r\n    const showDate2 = new Date(this.showDateFrom);\r\n    const { selector } = this.subElements;\r\n\r\n    showDate2.setMonth(showDate2.getMonth() + 1);\r\n\r\n    selector.innerHTML = `\r\n      <div class=\"rangepicker__selector-arrow\"></div>\r\n      <div class=\"rangepicker__selector-control-left\"></div>\r\n      <div class=\"rangepicker__selector-control-right\"></div>\r\n      ${this.renderCalendar(showDate1)}\r\n      ${this.renderCalendar(showDate2)}\r\n    `;\r\n\r\n    const controlLeft = selector.querySelector('.rangepicker__selector-control-left');\r\n    const controlRight = selector.querySelector('.rangepicker__selector-control-right');\r\n\r\n    controlLeft.addEventListener('click', () => this.prev());\r\n    controlRight.addEventListener('click', () => this.next());\r\n\r\n    this.renderHighlight();\r\n  }\r\n\r\n  prev() {\r\n    this.showDateFrom.setMonth(this.showDateFrom.getMonth() - 1);\r\n    this.renderDateRangePicker();\r\n  }\r\n\r\n  next() {\r\n    this.showDateFrom.setMonth(this.showDateFrom.getMonth() + 1);\r\n    this.renderDateRangePicker();\r\n  }\r\n\r\n  renderHighlight() {\r\n    const { from, to } = this.selected;\r\n\r\n    for (const cell of this.element.querySelectorAll('.rangepicker__cell')) {\r\n      const { value } = cell.dataset;\r\n      const cellDate = new Date(value);\r\n\r\n      cell.classList.remove('rangepicker__selected-from');\r\n      cell.classList.remove('rangepicker__selected-between');\r\n      cell.classList.remove('rangepicker__selected-to');\r\n\r\n      if (from && value === from.toISOString()) {\r\n        cell.classList.add('rangepicker__selected-from');\r\n      } else if (to && value === to.toISOString()) {\r\n        cell.classList.add('rangepicker__selected-to');\r\n      } else if (from && to && cellDate >= from && cellDate <= to) {\r\n        cell.classList.add('rangepicker__selected-between');\r\n      }\r\n    }\r\n\r\n    if (from) {\r\n      const selectedFromElem = this.element.querySelector(`[data-value=\"${from.toISOString()}\"]`);\r\n      if (selectedFromElem) {\r\n        selectedFromElem.closest('.rangepicker__cell').classList.add('rangepicker__selected-from');\r\n      }\r\n    }\r\n\r\n    if (to) {\r\n      const selectedToElem = this.element.querySelector(`[data-value=\"${to.toISOString()}\"]`);\r\n      if (selectedToElem) {\r\n        selectedToElem.closest('.rangepicker__cell').classList.add('rangepicker__selected-to');\r\n      }\r\n    }\r\n  }\r\n\r\n  renderCalendar(showDate) {\r\n    const date = new Date(showDate);\r\n    const getGridStartIndex = dayIndex => {\r\n      const index = dayIndex === 0 ? 6 : (dayIndex - 1);\r\n      return index + 1;\r\n    };\r\n\r\n    date.setDate(1);\r\n\r\n    const monthStr = date.toLocaleString('ru', {month: 'long'});\r\n\r\n    let table = `<div class=\"rangepicker__calendar\">\r\n      <div class=\"rangepicker__month-indicator\">\r\n        <time datetime=${monthStr}>${monthStr}</time>\r\n      </div>\r\n      <div class=\"rangepicker__day-of-week\">\r\n        <div>Пн</div><div>Вт</div><div>Ср</div><div>Чт</div><div>Пт</div><div>Сб</div><div>Вс</div>\r\n      </div>\r\n      <div class=\"rangepicker__date-grid\">\r\n    `;\r\n\r\n    table += `\r\n      <button type=\"button\"\r\n        class=\"rangepicker__cell\"\r\n        data-value=\"${date.toISOString()}\"\r\n        style=\"--start-from: ${getGridStartIndex(date.getDay())}\">\r\n          ${date.getDate()}\r\n      </button>`;\r\n\r\n    date.setDate(2);\r\n\r\n    while (date.getMonth() === showDate.getMonth()) {\r\n      table += `\r\n        <button type=\"button\"\r\n          class=\"rangepicker__cell\"\r\n          data-value=\"${date.toISOString()}\">\r\n            ${date.getDate()}\r\n        </button>`;\r\n\r\n      date.setDate(date.getDate() + 1);\r\n    }\r\n\r\n    table += '</div></div>';\r\n\r\n    return table;\r\n  }\r\n\r\n  onRangePickerCellClick(target) {\r\n    const { value } = target.dataset;\r\n\r\n    if (value) {\r\n      const dateValue = new Date(value);\r\n\r\n      if (this.selectingFrom) {\r\n        this.selected = {\r\n          from: dateValue,\r\n          to: null\r\n        };\r\n        this.selectingFrom = false;\r\n        this.renderHighlight();\r\n      } else {\r\n        if (dateValue > this.selected.from) {\r\n          this.selected.to = dateValue;\r\n        } else {\r\n          this.selected.to = this.selected.from;\r\n          this.selected.from = dateValue;\r\n        }\r\n\r\n        this.selectingFrom = true;\r\n        this.renderHighlight();\r\n      }\r\n\r\n      if (this.selected.from && this.selected.to) {\r\n        this.dispatchEvent();\r\n        this.close();\r\n        this.subElements.from.innerHTML = RangePicker.formatDate(this.selected.from);\r\n        this.subElements.to.innerHTML = RangePicker.formatDate(this.selected.to);\r\n      }\r\n    }\r\n  }\r\n\r\n  dispatchEvent() {\r\n    this.element.dispatchEvent(new CustomEvent('date-select', {\r\n      bubbles: true,\r\n      detail: this.selected,\r\n    }));\r\n  }\r\n\r\n  remove() {\r\n    this.element.remove();\r\n\r\n    document.removeEventListener('click', this.onDocumentClick, true);\r\n  }\r\n\r\n  destroy() {\r\n    this.remove();\r\n    this.element = null;\r\n    this.subElements = {};\r\n    this.selectingFrom = true;\r\n    this.selected = {\r\n      from: new Date(),\r\n      to: new Date()\r\n    };\r\n\r\n    return this;\r\n  }\r\n}\r\n","import fetchJson from '../../utils/fetch-json.js';\r\n\r\nconst BACKEND_URL = process.env.BACKEND_URL;\r\n\r\nexport default class SortableTable {\r\n  element;\r\n  subElements = {};\r\n  data = [];\r\n  loading = false;\r\n  start = 1;\r\n  step = 20;\r\n  end = this.start + this.step;\r\n\r\n  constructor(headersConfig = [], {\r\n    url = '',\r\n    sorted = {\r\n      id: headersConfig.find((item) => item.sortable).id,\r\n      order: 'asc'\r\n    },\r\n    isSortLocally = false,\r\n    step = 20,\r\n    start = 1,\r\n    end = start + step,\r\n    range,\r\n    rowTemplate = (html, item) => `\r\n      <div class=\"sortable-table__row\">\r\n        ${html}\r\n      </div>`\r\n  } = {}) {\r\n    this.headersConfig = headersConfig;\r\n    this.url = url;\r\n    this.sorted = sorted;\r\n    this.isSortLocally = isSortLocally;\r\n    this.step = step;\r\n    this.start = start;\r\n    this.end = end;\r\n    this.range = range;\r\n    this.rowTemplate = rowTemplate;\r\n\r\n    this.render();\r\n  }\r\n\r\n  onWindowScroll = async() => {\r\n    const { bottom } = this.element.getBoundingClientRect();\r\n    const { id, order } = this.sorted;\r\n\r\n    if (bottom < document.documentElement.clientHeight && !this.loading && !this.isSortLocally) {\r\n      this.start = this.end;\r\n      this.end = this.start + this.step;\r\n\r\n      this.loading = true;\r\n\r\n      const data = await this.loadData(id, order, this.start, this.end);\r\n\r\n      this.update(data);\r\n\r\n      this.loading = false;\r\n    }\r\n  }\r\n\r\n  getTemplate() {\r\n    return `\r\n      <div class=\"sortable-table\">\r\n        ${this.getTableHeader()}\r\n        ${this.getTableBody(this.data)}\r\n\r\n        <div data-element=\"loading\" class=\"loading-line sortable-table__loading-line\"></div>\r\n\r\n        <div data-element=\"emptyPlaceholder\" class=\"sortable-table__empty-placeholder\">\r\n          <div>\r\n            <p>No products satisfies your filter criteria</p>\r\n          </div>\r\n        </div>\r\n      </div>  \r\n      `;\r\n  }\r\n\r\n  getSubElements(element) {\r\n    const elements = element.querySelectorAll(`[data-element]`);\r\n\r\n    return [...elements].reduce((acc, subElement) => {\r\n      acc[subElement.dataset.element] = subElement;\r\n\r\n      return acc;\r\n    }, {});\r\n  }\r\n\r\n  getTableHeader() {\r\n    return `\r\n      <div data-element=\"header\" class=\"sortable-table__header sortable-table__row\">\r\n        ${this.headersConfig.map((header) => this.getHeaderRow(header)).join('')}\r\n      </div>`;  \r\n  }\r\n\r\n  getHeaderRow({ id, title, sortable }) {\r\n    const order = this.sorted.id === id ? this.sorted.order : 'asc';\r\n\r\n    return `\r\n      <div\r\n        class=\"sortable-table__cell\"\r\n        data-id=\"${id}\"\r\n        data-sortable=\"${sortable}\"\r\n        data-order=\"${order}\"\r\n      >\r\n        <span>${title}</span>\r\n        ${this.getHeaderSortingArrow(id)}\r\n      </div>`;\r\n  }\r\n\r\n  getHeaderSortingArrow(id) {\r\n    const isOrderExist = this.sorted.id === id ? this.sorted.order : '';\r\n\r\n    return isOrderExist\r\n      ? `<span data-element=\"arrow\" class=\"sortable-table__sort-arrow\">\r\n          <span class=\"sort-arrow\"></span>\r\n        </span>`\r\n      : '';\r\n  }\r\n\r\n  getTableBody(data) {\r\n    return `\r\n      <div data-element=\"body\" class=\"sortable-table__body\">\r\n        ${this.getTableRows(data)}\r\n      </div>`;\r\n  }\r\n\r\n  getTableRows(data) {\r\n    return data.map(item => this.rowTemplate(this.getTableRow(item), item)\r\n    ).join('');\r\n  }\r\n\r\n  getTableRow(item) {\r\n    const cells = this.headersConfig.map(({ id, template }) => {\r\n      return {\r\n        id,\r\n        template\r\n      };\r\n    });\r\n\r\n    return cells.map(({ id, template }) => {\r\n      return template\r\n        ? template(item[id])\r\n        : `<div class=\"sortable-table__cell\">${item[id]}</div>`; \r\n    })\r\n    .join(''); \r\n  }\r\n\r\n  async render() {\r\n    const {id, order} = this.sorted;\r\n    const wrapper = document.createElement('div');\r\n    \r\n    wrapper.innerHTML = this.getTemplate();\r\n\r\n    const element = wrapper.firstElementChild;\r\n\r\n    this.element = element;\r\n    this.subElements = this.getSubElements(element);\r\n\r\n    const data = await this.loadData(id, order, this.start, this.end);\r\n\r\n    this.renderRows(data);\r\n    this.initEventListeners();\r\n  }\r\n\r\n  async loadData(id, order, start = this.start, end = this.end) {\r\n    const url = new URL(this.url, BACKEND_URL);\r\n\r\n    url.searchParams.set('_sort', id);\r\n    url.searchParams.set('_order', order);\r\n    url.searchParams.set('_start', start);\r\n    url.searchParams.set('_end', end);\r\n\r\n    this.element.classList.add('sortable-table_loading');\r\n\r\n    const data = await fetchJson(url.toString());\r\n\r\n    this.element.classList.remove('sortable-table_loading');\r\n\r\n    return data;\r\n  }\r\n\r\n  sortOnClient(id, order) {\r\n    const sortedData = this.sortData(id, order);\r\n\r\n    this.subElements.body.innerHTML = this.getTableRows(sortedData);\r\n  }\r\n\r\n  async sortOnServer(id, order, start, end) {\r\n    const data = await this.loadData(id, order, start, end);\r\n\r\n    this.renderRows(data);\r\n  }\r\n\r\n  renderRows(data) {\r\n    if (data.length) {\r\n      this.element.classList.remove('sortable-table_empty');\r\n      this.addRows(data);\r\n    } else {\r\n      this.element.classList.add('sortable-table_empty');\r\n    }\r\n  }\r\n\r\n  addRows(data) {\r\n    this.data = data;\r\n\r\n    this.subElements.body.innerHTML = this.getTableRows(data);\r\n  }\r\n  \r\n  sortData(id, order) {\r\n    const arr = [...this.data];\r\n    const column = this.headersConfig.find((item) => item.id === id);\r\n\r\n    const { sortType } = column;\r\n    const directions = {\r\n      asc: 1,\r\n      desc: -1\r\n    };\r\n\r\n    const direction = directions[order];\r\n\r\n    return arr.sort((a, b) => {\r\n      switch (sortType) {\r\n      case \"number\":\r\n        return direction * (a[id] - b[id]);\r\n      case \"string\":\r\n        return direction * a[id].localeCompare(b[id], [\"ru\", \"en\"]);\r\n      default:\r\n        return direction * (a[id] - b[id]);\r\n      }\r\n    });\r\n  }\r\n\r\n  onHeaderClick = async (event) => {\r\n    const column = event.target.closest('[data-sortable=\"true\"]');\r\n\r\n    if (!column) {\r\n      return;\r\n    }\r\n\r\n    this.start = 0;\r\n    this.end = this.start + this.step;\r\n\r\n    const order = column.dataset.order === 'asc' ? 'desc' : 'asc';\r\n    column.dataset.order = order;\r\n\r\n    const arrow = column.querySelector('.sortable-table__sort-arrow');\r\n\r\n    if (!arrow) {\r\n      column.append(this.subElements.arrow);\r\n    }\r\n\r\n    if (this.isSortLocally) {\r\n      this.sortOnClient(column.dataset.id, order, this.start, this.end);\r\n    } else {\r\n      this.sortOnServer(column.dataset.id, order, this.start, this.end);\r\n    }\r\n  }\r\n\r\n  update(data) {\r\n    const rows = document.createElement('div');\r\n\r\n    this.data = [...this.data, ...data];\r\n    rows.innerHTML = this.renderRows(data);\r\n\r\n    this.subElements.body.append(...rows.childNodes);\r\n  }\r\n\r\n  initEventListeners() {\r\n    this.subElements.header.addEventListener('pointerdown', this.onHeaderClick);\r\n\r\n    window.addEventListener('scroll', this.onWindowScroll);\r\n  }\r\n    \r\n  remove() {\r\n    if (this.element) {\r\n      this.element.remove();\r\n    }\r\n  }\r\n    \r\n  destroy() {\r\n    this.remove();\r\n    this.element = null;\r\n    this.subElements = {};\r\n\r\n    window.removeEventListener('scroll', this.onWindowScroll);\r\n  }\r\n\r\n}\r\n","import fetchJson from '../../utils/fetch-json.js';\r\n\r\nconst BACKEND_URL = process.env.BACKEND_URL;\r\n\r\nexport default class ColumnChart {\r\n  element;\r\n  subElements = {};\r\n  chartHeight = 50;\r\n\r\n  constructor({\r\n    label = '',\r\n    link = '',\r\n    formatHeading = data => data,\r\n    url = '',\r\n    range = {\r\n      from: new Date(),\r\n      to: new Date(),\r\n    }\r\n  } = {}) {\r\n    this.url = new URL(url, BACKEND_URL);\r\n    this.range = range;\r\n    this.label = label;\r\n    this.link = link;\r\n    this.formatHeading = formatHeading;\r\n\r\n    this.render();\r\n  }\r\n\r\n  async loadData(from, to) {\r\n    this.element.classList.add('column-chart_loading');\r\n    this.subElements.header.textContent = '';\r\n    this.subElements.body.innerHTML = '';\r\n\r\n    this.url.searchParams.set('from', from.toISOString());\r\n    this.url.searchParams.set('to', to.toISOString());\r\n\r\n    const data = await fetchJson(this.url);\r\n\r\n    this.setNewRange(from, to);\r\n\r\n    if (data && Object.values(data).length) {\r\n      this.subElements.header.textContent = this.getHeaderValue(data);\r\n      this.subElements.body.innerHTML = this.getColumnBody(data);\r\n\r\n      this.element.classList.remove('column-chart_loading');\r\n    }\r\n  }\r\n\r\n  getTemplate() {\r\n    return `\r\n      <div class=\"column-chart column-chart_loading\" style=\"--chart-height: ${this.chartHeight}\">\r\n        <div class=\"column-chart__title\">\r\n          Total ${this.label}\r\n          ${this.getLink()}\r\n        </div>\r\n        <div class=\"column-chart__container\">\r\n          <div data-element=\"header\" class=\"column-chart__header\"></div>\r\n          <div data-element=\"body\" class=\"column-chart__chart\"></div>\r\n        </div>\r\n      </div>\r\n    `;\r\n  }\r\n\r\n  getHeaderValue(data) {\r\n    return this.formatHeading(Object.values(data).reduce((accum, item) => (accum + item), 0));\r\n  }\r\n\r\n  setNewRange(from, to) {\r\n    this.range.from = from;\r\n    this.range.to = to;\r\n  }\r\n\r\n  getColumnBody(data) {\r\n    const maxValue = Math.max(...Object.values(data));\r\n\r\n    return Object.entries(data).map(([key, value]) => {\r\n      const scale = this.chartHeight / maxValue;\r\n      const percent = (value / maxValue * 100).toFixed(0);\r\n      const tooltip = `<span>\r\n        <small>${key.toLocaleString('default', {dateStyle: 'medium'})}</small>\r\n        <br>\r\n        <strong>${percent}%</strong>\r\n      </span>`;\r\n\r\n      return `<div style=\"--value: ${Math.floor(value * scale)}\" data-tooltip=\"${tooltip}\"></div>`;\r\n    }).join('');\r\n  }\r\n\r\n  getLink() {\r\n    return this.link ? `<a class=\"column-chart__link\" href=\"${this.link}\">View all</a>` : '';\r\n  }\r\n\r\n  getSubElements(element) {\r\n    const elements = element.querySelectorAll('[data-element]');\r\n\r\n    return [...elements].reduce((accum, subElement) => {\r\n      accum[subElement.dataset.element] = subElement;\r\n\r\n      return accum;\r\n    }, {});\r\n  }\r\n\r\n  render() {\r\n    const { from, to } = this.range;\r\n    const element = document.createElement('div');\r\n\r\n    element.innerHTML = this.getTemplate();\r\n\r\n    this.element = element.firstElementChild;\r\n    this.subElements = this.getSubElements(this.element);\r\n\r\n    this.loadData(from, to);\r\n  }\r\n\r\n  async update(from, to) {\r\n    return await this.loadData(from, to);\r\n  }\r\n\r\n  remove() {\r\n    if (this.element) {\r\n      this.element.remove();\r\n    }\r\n  }\r\n\r\n  destroy() {\r\n    this.remove();\r\n    this.element = null;\r\n    this.subElements = {};\r\n  }\r\n}\r\n","const header = [\r\n  {\r\n    id: 'images',\r\n    title: 'Image',\r\n    sortable: false,\r\n    template: data => {\r\n      return `\r\n          <div class=\"sortable-table__cell\">\r\n            <img class=\"sortable-table-image\" alt=\"Image\" src=\"${data[0].url}\">\r\n          </div>\r\n        `;\r\n    }\r\n  },\r\n  {\r\n    id: 'title',\r\n    title: 'Name',\r\n    sortable: true,\r\n    sortType: 'string'\r\n  },\r\n  {\r\n    id: 'quantity',\r\n    title: 'Quantity',\r\n    sortable: true,\r\n    sortType: 'number'\r\n  },\r\n  {\r\n    id: 'price',\r\n    title: 'Price',\r\n    sortable: true,\r\n    sortType: 'number'\r\n  },\r\n  {\r\n    id: 'status',\r\n    title: 'Status',\r\n    sortable: true,\r\n    sortType: 'number',\r\n    template: data => {\r\n      return `<div class=\"sortable-table__cell\">\r\n          ${data > 0 ? 'Active' : 'Inactive'}\r\n        </div>`;\r\n    }\r\n  },\r\n];\r\n\r\nexport default header;\r\n","import RangePicker from '../../components/range-picker/index.js';\r\nimport SortableTable from '../../components/sortable-table/index.js';\r\nimport ColumnChart from '../../components/column-chart/index.js';\r\nimport header from './bestsellers-header.js';\r\n\r\nimport fetchJson from '../../utils/fetch-json.js';\r\n\r\nexport default class Page {\r\n  element;\r\n  subElements = {};\r\n  components = {};\r\n  range = {\r\n    from: new Date(new Date().setMonth(new Date().getMonth() - 1)),\r\n    to: new Date()\r\n  };\r\n  url = new URL('api/dashboard/bestsellers', process.env.BACKEND_URL);\r\n\r\n  initialize() {\r\n    this.initEventListeners();\r\n  }\r\n\r\n  getTemplate() {\r\n    return `\r\n      <div class=\"dashboard\">\r\n        <div class=\"content__top-panel\">\r\n          <h2 class=\"page-title\">Dashboard</h2>\r\n          <!-- RangePicker component -->\r\n          <div data-element=\"rangePicker\"></div>\r\n        </div>\r\n        <div data-element=\"chartsRoot\" class=\"dashboard__charts\">\r\n          <!-- column-chart components -->\r\n          <div data-element=\"ordersChart\" class=\"dashboard__chart_orders\"></div>\r\n          <div data-element=\"salesChart\" class=\"dashboard__chart_sales\"></div>\r\n          <div data-element=\"customersChart\" class=\"dashboard__chart_customers\"></div>\r\n        </div>\r\n\r\n        <h3 class=\"block-title\">Best sellers</h3>\r\n\r\n        <div data-element=\"sortableTable\">\r\n          <!-- sortable-table component -->\r\n        </div>\r\n      </div>\r\n    `;\r\n  }\r\n\r\n  initComponents() {\r\n    const from = this.range.from;\r\n    const to = this.range.to;\r\n\r\n    const rangePicker = new RangePicker({\r\n      from,\r\n      to\r\n    });\r\n\r\n    const sortableTable = new SortableTable(header, {\r\n      url: 'api/dashboard/bestsellers',\r\n      isSortLocally: true,\r\n      range: {\r\n        from,\r\n        to\r\n      },\r\n    });\r\n\r\n    const ordersChart = new ColumnChart({\r\n      url: 'api/dashboard/orders',\r\n      range: {\r\n        from,\r\n        to\r\n      },\r\n      label: 'orders',\r\n      link: '/sales'\r\n    });\r\n\r\n    const salesChart = new ColumnChart({\r\n      url: 'api/dashboard/sales',\r\n      range: {\r\n        from,\r\n        to\r\n      },\r\n      label: 'sales',\r\n      formatHeading: data => `$${data}`\r\n    });\r\n\r\n    const customersChart = new ColumnChart({\r\n      url: 'api/dashboard/customers',\r\n      range: {\r\n        from,\r\n        to\r\n      },\r\n      label: 'customers',\r\n    });\r\n\r\n    this.components = {\r\n      sortableTable,\r\n      rangePicker,\r\n      ordersChart,\r\n      salesChart,\r\n      customersChart\r\n    };\r\n  }\r\n\r\n  getComponents() {\r\n    Object.keys(this.components).forEach(component => {\r\n      const root = this.subElements[component];\r\n      const { element } = this.components[component];\r\n\r\n      root.append(element);\r\n    });\r\n  }\r\n\r\n  getSubElements(element) {\r\n    const elements = element.querySelectorAll(`[data-element]`);\r\n\r\n    return [...elements].reduce((acc, subElement) => {\r\n      acc[subElement.dataset.element] = subElement;\r\n\r\n      return acc;\r\n    }, {});\r\n  }\r\n\r\n  render() {\r\n    const wrapper = document.createElement('div');\r\n\r\n    wrapper.innerHTML = this.getTemplate();\r\n\r\n    this.element = wrapper.firstElementChild;\r\n\r\n    this.subElements = this.getSubElements(this.element);\r\n\r\n    this.initComponents();\r\n    this.getComponents();\r\n    this.initEventListeners();\r\n    \r\n    this.update(this.range.from, this.range.to);\r\n    \r\n    return this.element;\r\n  }\r\n\r\n  onRangeSelect = (event) => {\r\n    const { from, to } = event.detail;\r\n\r\n    this.update(from, to);\r\n  }\r\n\r\n  async loadData(from, to) {\r\n    this.url.searchParams.set('_sort', 'title');\r\n    this.url.searchParams.set('_order', 'asc');\r\n    this.url.searchParams.set('_start', '1');\r\n    this.url.searchParams.set('_end', '20');\r\n    this.url.searchParams.set('from', from.toISOString());\r\n    this.url.searchParams.set('to', to.toISOString());\r\n\r\n    const data = await fetchJson(this.url);\r\n\r\n    return data;\r\n  }\r\n\r\n  async update(from, to) {\r\n    const { sortableTable, ordersChart, salesChart, customersChart } = this.components;\r\n\r\n    const data = await this.loadData(from, to);\r\n\r\n    sortableTable.update(data);\r\n    ordersChart.update(from, to);\r\n    salesChart.update(from, to);\r\n    customersChart.update(from, to);\r\n  }\r\n\r\n  initEventListeners() {\r\n    const { rangePicker } = this.components;\r\n\r\n    rangePicker.element.addEventListener('date-select', this.onRangeSelect);\r\n  }\r\n\r\n  remove() {\r\n    if (this.element) {\r\n      this.element.remove();\r\n    }\r\n  }\r\n\r\n  destroy() {\r\n    this.remove();\r\n    this.element = null;\r\n    this.subElements = {};\r\n    this.components = {};\r\n    Object.values(this.components).forEach((component) => {\r\n      component.destroy();\r\n    });\r\n  }\r\n\r\n}\r\n","// same as fetch, but throws FetchError in case of errors\r\n// status >= 400 is an error\r\n// network error / json error are errors\r\n\r\nexport default async function(url, params) {\r\n  let response;\r\n\r\n  try {\r\n    // NOTE: \"toString\" call needed for correct work of \"jest-fetch-mock\"\r\n    response = await fetch(url.toString(), params);\r\n  } catch(err) {\r\n    throw new FetchError(response, \"Network error has occurred.\");\r\n  }\r\n\r\n  let body;\r\n\r\n  if (!response.ok) {\r\n    let errorText = response.statusText; // Not Found (for 404)\r\n\r\n    try {\r\n      body = await response.json();\r\n\r\n      errorText = (body.error && body.error.message) || (body.data && body.data.error && body.data.error.message) || errorText;\r\n    } catch (error) { /* ignore failed body */ }\r\n\r\n    let message = `Error ${response.status}: ${errorText}`;\r\n\r\n    throw new FetchError(response, body, message);\r\n  }\r\n\r\n  try {\r\n    return await response.json();\r\n  } catch(err) {\r\n    throw new FetchError(response, null, err.message);\r\n  }\r\n}\r\n\r\nexport class FetchError extends Error {\r\n  name = \"FetchError\";\r\n\r\n  constructor(response, body, message) {\r\n    super(message);\r\n    this.response = response;\r\n    this.body = body;\r\n  }\r\n}\r\n\r\n// handle uncaught failed fetch through\r\nwindow.addEventListener('unhandledrejection', event => {\r\n  if (event.reason instanceof FetchError) {\r\n    alert(event.reason.message);\r\n  }\r\n});\r\n\r\n"],"sourceRoot":""}